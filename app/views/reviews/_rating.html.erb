<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

<script>
  $(document).ready(function() {
    window.ratingRefresh = () => {
      const normal_flag = '<%= asset_url('flag') %>';
      const colored_flag = '<%= asset_url('flag_colored') %>';
      let englishRating = $('input[name="review[english_rating]"]:checked', '#new_review').val() || 0;

      const updateFlags = value => {
        $('.flags').attr('src', normal_flag);
        $('.flags').slice(0, value).attr('src', colored_flag);
      }

      updateFlags(englishRating)

      $('.flags').click(function() {
        const input = $(this).parent().find('input')
        englishRating = input[0].value

        updateFlags(englishRating);
      });
    };

    window.ratingRefresh();
  });
</script>

<div class="rating">
  <label>
    <%= image_tag "flag", class: "flags", id: "rating_1" %>
    <input type="radio" name='<%= name %>' value="1" style='visibility: hidden'/>
  </label>
  <label>
    <%= image_tag "flag", class: "flags", id: "rating_2" %>
    <input type="radio" name='<%= name %>' value="2" style='visibility: hidden'/>
  </label>
  <label>
    <%= image_tag "flag", class: "flags", id: "rating_3" %>
    <input type="radio" name='<%= name %>' value="3" style='visibility: hidden'/>
  </label>
  <label>
    <%= image_tag "flag", class: "flags", id: "rating_4" %>
    <input type="radio" name='<%= name %>' value="4" style='visibility: hidden'/>
  </label>
  <label>
    <%= image_tag "flag", class: "flags", id: "rating_5" %>
    <input type="radio" name='<%= name %>' value="5" style='visibility: hidden'/>
  </label>
</div>
